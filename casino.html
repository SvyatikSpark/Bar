<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–°–ø–∞–º–µ—Ä–±—É–∫ - –ö–∞–∑–∏–∫</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="container" id="auth-form">
    <h2>–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è</h2>
    <input type="text" id="username" placeholder="–ù–∏–∫–Ω–µ–π–º">
    <input type="password" id="password" placeholder="–ü–∞—Ä–æ–ª—å">
    <button onclick="auth()">–í–æ–π—Ç–∏</button>
    <button onclick="showRegistrationForm()">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</button>
  </div>

  <div class="container" id="registration-form" style="display: none;">
    <h2>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</h2>
    <input type="text" id="reg-username" placeholder="–ù–∏–∫–Ω–µ–π–º">
    <input type="password" id="reg-password" placeholder="–ü–∞—Ä–æ–ª—å">
    <button onclick="register()">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</button>
  </div>

  <nav class="hamburger-menu">
    <input type="checkbox" id="menu-toggle">
    <label for="menu-toggle" class="menu-button">‚ò∞</label>
    <ul class="menu-links">
      <li><a href="creobot.html">CreoBot</a></li>
      <li><a href="hall-of-fame.html">Hall of Fame</a></li>
      <li><a href="#" onclick="logout()" id="logout-link" style="display: none;">–í—ã–π—Ç–∏</a></li> 
    </ul>
  </nav>

  <div class="container" id="game-container" style="display: none;">
    <h1>–ö–∞–∑–∏–∫</h1>
    <p>–ë–∞–ª–∞–Ω—Å: <span id="balance">–ó–∞–≥—Ä—É–∑–∫–∞...</span></p>
    <input type="number" id="bet-amount" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å—É–º–º—É">
    <button onclick="playGame()">–ò–≥—Ä–∞—Ç—å</button>
    <div id="animation-container">
      <div class="reel" id="reel1"></div>
      <div class="reel" id="reel2"></div>
      <div class="reel" id="reel3"></div>
    </div> 
    <div id="game-result"></div>

    <h2>–¢–∞–±–ª–∏—Ü–∞ –ª–∏–¥–µ—Ä–æ–≤</h2>
    <table id="leaderboard">
      <thead>
        <tr>
          <th>–ú–µ—Å—Ç–æ</th>
          <th>–ù–∏–∫–Ω–µ–π–º</th>
          <th>–ë–∞–ª–∞–Ω—Å</th>
        </tr>
      </thead>
      <tbody>
        <tr><td colspan="3">–ó–∞–≥—Ä—É–∑–∫–∞...</td></tr> 
      </tbody>
    </table>
  </div>

  <script>!function(e,t,a){var c=e.head||e.getElementsByTagName("head")[0],n=e.createElement("script");n.async=!0,n.defer=!0, n.type="text/javascript",n.src=t+"/static/js/widget.js?config="+JSON.stringify(a),c.appendChild(n)}(document,"https://app.engati.com",{bot_key:"bf4aded73cd94d58",welcome_msg:true,branding_key:"default",server:"https://app.engati.com",e:"p" });</script>

  <script>const emojis = ["–≤–∞–ª–µ—Ä–∞", "üî•", "üîû", "ü§ñ", "üíã", "üçì"];
    const dataFile = 'data.txt'; 
    let users = []; 
    
    document.addEventListener('DOMContentLoaded', () => {
        loadUsers(); 
        checkAuth();
    });
    
    function getRandomEmoji() {
      return emojis[Math.floor(Math.random() * emojis.length)];
    }
    
    function playGame() {
      const betAmount = parseInt(document.getElementById('bet-amount').value);
      if (isNaN(betAmount) || betAmount <= 0) {
        alert('–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—É—é —Å—É–º–º—É!');
        return;
      }
    
      const username = localStorage.getItem('user'); 
      const user = users.find(user => user.username === username);
    
      if (user.balance < betAmount) { 
          alert('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤!');
          return; 
      }
    
      const reels = [
        document.getElementById('reel1'),
        document.getElementById('reel2'),
        document.getElementById('reel3')
      ];
    
      const result = [];
    
      reels.forEach(reel => {
        reel.innerHTML = ''; 
      });
    
      for (let i = 0; i < reels.length; i++) {
        const randomEmoji = getRandomEmoji();
        reels[i].textContent = randomEmoji;
        result[i] = randomEmoji;
      }
    
      const uniqueEmojis = new Set(result);
      const resultMessage = document.getElementById('game-result');
      let winAmount = 0;
      if (uniqueEmojis.size === 1) {
        winAmount = betAmount * 10;
        resultMessage.textContent = `–í—ã –≤—ã–∏–≥—Ä–∞–ª–∏! (+${winAmount} –º–æ–Ω–µ—Ç)`;
      } else if (uniqueEmojis.size === 2) {
        winAmount = betAmount * 0.3;
        resultMessage.textContent = `–í—ã –≤—ã–∏–≥—Ä–∞–ª–∏! (+${winAmount} –º–æ–Ω–µ—Ç)`;
      } else {
        winAmount = -betAmount;
        resultMessage.textContent = `–í—ã –ø—Ä–æ–∏–≥—Ä–∞–ª–∏! (-${betAmount} –º–æ–Ω–µ—Ç)`;
      }
      updateBalance(winAmount);
    }
    
    function checkAuth() {
      const username = localStorage.getItem('user');
      if (username) {
        setTimeout(() => {
          const user = users.find(user => user.username === username);
          if (user) {
            showGame(user);
            updateLeaderboard();
          } else {
            logout();
          }
        }, 1000); 
      } else {
        document.getElementById('auth-form').style.display = 'flex';
      }
    }
    
    function auth() {
      const username = document.getElementById('username').value;
      const password = document.getElementById('password').value;
    
      setTimeout(() => {
        const user = users.find(user => user.username === username && user.password === password);
        if (user) {
          localStorage.setItem('user', username);
          showGame(user);
          updateLeaderboard();
        } else {
          alert('–ù–µ–≤–µ—Ä–Ω—ã–π –ª–æ–≥–∏–Ω –∏–ª–∏ –ø–∞—Ä–æ–ª—å!');
        }
      }, 1000);
    }
    
    function showRegistrationForm() {
      document.getElementById('auth-form').style.display = 'none';
      document.getElementById('registration-form').style.display = 'flex';
    }
    
    function register() {
      const username = document.getElementById('reg-username').value;
      const password = document.getElementById('reg-password').value;
      setTimeout(() => {
        const existingUser = users.find(user => user.username === username);
        if (existingUser) {
          alert('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å —Ç–∞–∫–∏–º –Ω–∏–∫–æ–º —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç!');
        } else {
          const newUser = { username, password, balance: 1000 };
          users.push(newUser);
          saveUsers(); 
          alert('–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø—Ä–æ—à–ª–∞ —É—Å–ø–µ—à–Ω–æ!');
          document.getElementById('registration-form').style.display = 'none';
          document.getElementById('auth-form').style.display = 'flex';
        }
      }, 1000);
    }
    
    function logout() {
      localStorage.removeItem('user');
      document.getElementById('game-container').style.display = 'none';
      document.getElementById('auth-form').style.display = 'flex';
      document.getElementById('logout-link').style.display = 'none';
    }
    
    function showGame(user) {
      document.getElementById('auth-form').style.display = 'none';
      document.getElementById('registration-form').style.display = 'none';
      document.getElementById('game-container').style.display = 'flex';
      document.getElementById('logout-link').style.display = 'block';
      document.getElementById('balance').textContent = `–ë–∞–ª–∞–Ω—Å: ${user.balance}`;
    }
    
    function updateBalance(amount) {
      const username = localStorage.getItem('user');
      if (!username) return;
      const user = users.find(user => user.username === username);
      if (user) {
        user.balance = Math.floor(user.balance + amount); 
        if (user.balance < 0) {
          user.balance = 0;
        }
        saveUsers();
        document.getElementById('balance').textContent = `–ë–∞–ª–∞–Ω—Å: ${user.balance}`;
        updateLeaderboard();
      }
    }
    
    function updateLeaderboard() {
        const leaderboardTbody = document.querySelector('#leaderboard tbody');
        leaderboardTbody.innerHTML = ''; 
    
        users
        .sort((a, b) => b.balance - a.balance) 
        .forEach((user, index) => {
            const row = leaderboardTbody.insertRow();
            row.insertCell().textContent = index + 1;
            row.insertCell().textContent = user.username;
            row.insertCell().textContent = user.balance;
        });
    }
    
    function loadUsers() {
      const data = localStorage.getItem('users');
      if (data) {
        users = JSON.parse(data);
      } else {
        users = []; 
      }
    }
    
    function saveUsers() {
      localStorage.setItem('users', JSON.stringify(users));
    }
    
    function deleteUser(username) {
      const userIndex = users.findIndex(user => user.username === username);
      if (userIndex !== -1) {
        users.splice(userIndex, 1);
        saveUsers();
        updateLeaderboard();
        alert(`–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å ${username} —É–¥–∞–ª–µ–Ω.`);
      } else {
        alert(`–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å ${username} –Ω–µ –Ω–∞–π–¥–µ–Ω.`);
      }
    }
    
    function changeBalance(username, newBalance) {
      const user = users.find(user => user.username === username);
      if (user) {
        user.balance = newBalance; 
        saveUsers();
        updateLeaderboard();
        alert(`–ë–∞–ª–∞–Ω—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è ${username} –∏–∑–º–µ–Ω–µ–Ω –Ω–∞ ${newBalance}.`);
      } else {
        alert(`–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å ${username} –Ω–µ –Ω–∞–π–¥–µ–Ω.`);
      }
    }
    
    function deleteUserConsole() {
      const username = prompt("–í–≤–µ–¥–∏—Ç–µ –Ω–∏–∫–Ω–µ–π–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è:");
      if (username) {
        deleteUser(username);
      } else {
        console.log("–£–¥–∞–ª–µ–Ω–∏–µ –æ—Ç–º–µ–Ω–µ–Ω–æ.");
      }
    }
    
    function changeBalanceConsole() {
      const username = prompt("–í–≤–µ–¥–∏—Ç–µ –Ω–∏–∫–Ω–µ–π–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:");
      if (username) {
        const newBalanceStr = prompt("–í–≤–µ–¥–∏—Ç–µ –Ω–æ–≤—ã–π –±–∞–ª–∞–Ω—Å:");
        const newBalance = parseInt(newBalanceStr);
        if (!isNaN(newBalance)) {
          changeBalance(username, newBalance);
        } else {
          console.log("–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –±–∞–ª–∞–Ω—Å–∞.");
        }
      } else {
        console.log("–ò–∑–º–µ–Ω–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞ –æ—Ç–º–µ–Ω–µ–Ω–æ.");
      }
    }</script> </body>
</html>
